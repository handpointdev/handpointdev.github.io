"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[78236],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>c});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=d(a),c=r,k=u["".concat(s,".").concat(c)]||u[c]||m[c]||l;return a?n.createElement(k,i(i({ref:t},p),{},{components:a})):n.createElement(k,i({ref:t},p))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var d=2;d<l;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},57129:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const l={sidebar_position:6,id:"restendpoints"},i="REST API Endpoints",o={unversionedId:"restendpoints",id:"restendpoints",title:"REST API Endpoints",description:"/initialize",source:"@site/restapi/restendpoints.md",sourceDirName:".",slug:"/restendpoints",permalink:"/restapi/next/restendpoints",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,id:"restendpoints"},sidebar:"tutorialSidebar",previous:{title:"Handpoint Sandbox",permalink:"/restapi/next/restsandbox"},next:{title:"Objects",permalink:"/restapi/next/restobjects"}},s={},d=[{value:"/initialize",id:"initialize",level:2},{value:"/transactions",id:"transactions",level:2},{value:"/transaction-result/{transactionResultId}",id:"transaction-resulttransactionresultid",level:2},{value:"/transactions/{guid}/tip-adjustment",id:"transactionsguidtip-adjustment",level:2},{value:"Transaction Result Recovery",id:"transaction-result-recovery",level:2},{value:"/transactions/{transactionReference}/status",id:"transactionstransactionreferencestatus",level:2},{value:"/transactions/{transactionReference}/status/{selector}",id:"transactionstransactionreferencestatusselector",level:2},{value:"Device Control Commands",id:"device-control-commands",level:2},{value:"Set Unattended Mode",id:"set-unattended-mode",level:3},{value:"Set Locale",id:"set-locale",level:3},{value:"Set Password Protection",id:"set-password-protection",level:3},{value:"Reboot Device",id:"reboot-device",level:3},{value:"Set Screen Brightness",id:"set-screen-brightness",level:3},{value:"Set Reboot Time",id:"set-reboot-time",level:3},{value:"MOTO Operations (no reader)",id:"moto-operations-no-reader",level:2},{value:"/moto/sale",id:"motosale",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Behaviour examples",id:"behaviour-examples",level:4},{value:"Code example \u2013 MOTO sale with <code>cardToken</code>",id:"code-example--moto-sale-with-cardtoken",level:4},{value:"/moto/refund",id:"motorefund",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"Returns",id:"returns-1",level:4},{value:"Behaviour examples",id:"behaviour-examples-1",level:4},{value:"Code example \u2013 partial MOTO refund by <code>originalGuid</code>",id:"code-example--partial-moto-refund-by-originalguid",level:4},{value:"/moto/reversal",id:"motoreversal",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"Returns",id:"returns-2",level:4},{value:"Behaviour examples",id:"behaviour-examples-2",level:4},{value:"Code example \u2013 MOTO reversal by <code>originalGuid</code>",id:"code-example--moto-reversal-by-originalguid",level:4},{value:"Batch Operations",id:"batch-operations",level:2},{value:"/batch/close",id:"batchclose",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"Returns",id:"returns-3",level:4},{value:"Behaviour examples",id:"behaviour-examples-3",level:4},{value:"Code example \u2013 Close batch via <code>curl</code>",id:"code-example--close-batch-via-curl",level:4}],p={toc:d};function m(e){let{components:t,...l}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"rest-api-endpoints"},"REST API Endpoints"),(0,r.kt)("h2",{id:"initialize"},"/initialize"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Initialize")),(0,r.kt)("p",null,"Initializes the REST API client and returns the list of payment terminals associated with the merchant account. We recommend that you display the list of available payment terminals to the merchant in your software. Each API key is unique per merchant and needs to be configurable in your backend. "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"    ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")))),(0,r.kt)("p",null,"Returns"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Devices"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"List of ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#deviceObject"},"Device")," object.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Code Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Operation executed using CLI tool CURL:\n\nREQUEST:\n  curl -X GET \\\n   -H "ApiKeyCLoud: MeRcHaNt-ApIkEy" \\\n   "https://cloud.handpoint.com/initialize" (production)\n   "https://cloud.handpoint.io/initialize" (development)\n\nRESPONSE:\n Code 200 -> Body:\n  [\n    {\n      "merchant_id_alpha": "merchantID",\n      "serial_number": "082104578",\n      "ssk": "A1B2C3D4E5F60718293A4B5C6D7E8F901A2B3C4D5E6F7890ABCDEF0123456789",\n      "terminal_type": "PAXA920"\n    }\n  ]\n')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Reminder that SSK (Shared Secret Key) is a value unique to a Merchant, and the same Merchant (SSK) can have assigned multiple devices from different manufacturers. This includes PAX and Datecs (eg. HiLite)")),(0,r.kt)("h2",{id:"transactions"},"/transactions"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Transactions")),(0,r.kt)("p",null,"POST endpoint used to send a financial operation to the payment terminal. The transaction type to be executed (sale, refund etc.) is defined in the ",(0,r.kt)("inlineCode",{parentName:"p"},"operation")," field of the request body. "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: Transaction Request")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"  ",(0,r.kt)("br",null),(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transactionRequest"},"TransactionRequest")),(0,r.kt)("td",{parentName:"tr",align:null},"Object containing the transaction request information.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returns")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response"),(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Transaction Accepted")),(0,r.kt)("td",{parentName:"tr",align:null},"The response code 202 is received from the API if the transaction was successfully sent to the payment terminal.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BadRequest DeviceIsBusy Error")),(0,r.kt)("td",{parentName:"tr",align:null},"The response code 400 with error 1001 is received from the API if the payment terminal is already processing a transaction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BadRequest DeviceNotResponding Error")),(0,r.kt)("td",{parentName:"tr",align:null},"The response code 400 with error 1002 is received from the API if the payment terminal is offline.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BadRequest CancelOperationNotAllowed Error")),(0,r.kt)("td",{parentName:"tr",align:null},"The response code 400 with error 1003 is received from the API if the stopCurrentTransaction operation cannot be executed. A transaction can only be cancelled at specific steps of the transaction, while waiting for the card to be inserted or on PIN screen.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Code Example")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Make sure that your transactionReference is unique per request, and change it for every new request attempt (even if the request contains the same values re-attempt). This will improve logs and could help troubleshooting.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Operation executed using CLI tool CURL:\nREQUEST:\n    curl -X POST \\\\\n     -H"ApiKeyCLoud: MeRcHaNt-ApIkEy" \\\\\n     -H"Content-Type: application/json" \\\\\nTransaction Request without callbackUrl and token\n     -d \'{\n         "operation":"sale",\n         "amount":"10000",\n         "currency":"EUR",\n         "terminal_type":"PAXA920",\n         "serial_number":"1547854757",\n         "customerReference":"op15248",\n         "transactionReference": "2bfde1fc-23b1-4c67-93d9-1d4a557f4d4f"\n          }\' \\\\\nTransaction Request with callbackUrl and token\n     -d \'{\n         "operation":"sale",\n         "amount":"10000",\n         "currency":"EUR",\n         "terminal_type":"PAXA920",\n         "serial_number":"1547854757",\n         "customerReference":"op15248",\n         "callbackUrl":"https://url.where.the.result.is.served.com",\n         "token":"123456789",\n         "transactionReference": "2bfde1fc-23b1-4c67-93d9-1d4a557f4d4f"\n          }\' \\\\  \n   "https://cloud.handpoint.com/transactions" (production)\n   "https://cloud.handpoint.io/transactions" (development)\n\nRESPONSES:\n  Code 202\nTransaction Request without callbackUrl\n    {\n      "transactionResultId": "0821032398-1628774190395",\n      "statusMessage": "Operation Accepted",\n      "transactionReference":"00000000-0000-0000-0000-000000000000"\n    }\n \nTransaction Request with callbackUrl and token\n    {\n      "statusMessage": "Operation Accepted",\n      "transactionReference":"00000000-0000-0000-0000-000000000000"\n    }\n\n  Code 400 Ex:DeviceIsBusy\n    {\n    "error": {\n      "statusCode": 400,\n      "name":"BadRequestError",\n      "message": {\n          "error": 1001,\n          "message":"The device is busy"\n        }\n      }\n    }\n')),(0,r.kt)("h2",{id:"transaction-resulttransactionresultid"},"/transaction-result/{transactionResultId}"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"TransactionResultRetrieval")),(0,r.kt)("p",null,"GET endpoint used to retrieve transaction results from the payment terminal. In case you do not provide a callbackURL and token in the transaction request, the terminal will post the transaction result to an Handpoint internal API which can be queried in order for your software to fetch the transaction result. If you are running a server to receive results and pass a callback URL and token as part of the transaction request you do not need to query this endpoint.  "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Path parameter: transactionResultId")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"The transactionResultId is a unique transaction id delivered immediately as a response to your transaction request. It can be used to query for a transaction result.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returns")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response"),(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"No Content")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code 204. The transactionResultId was found in the database but there is no transaction result associated yet. This status will be retrieved while the transaction is ongoing and the transaction result has not been delivered yet.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"OK")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code 200 + Transaction Result. The transactionResultId was found in the database and the associated Transaction Result object is delivered.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Not Found")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code 404. The transactionResultId was not found in the database.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Code Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Operation executed using CLI tool CURL:\nREQUEST:\n    curl -X GET \\\\\n      -H"ApiKeyCLoud: MeRcHaNt-ApIkEy" \\\\\n      "https://cloud.handpoint.com/transaction-result/0821032398-1628774190395" (production)\n      "https://cloud.handpoint.io/transaction-result/0821032398-1628774190395" (development)\n\nRESPONSE:\n{\n  "aid": "A0000000041010",\n  "arc": "0000",\n  "authorisationCode": "123456",\n  "balance": null,\n  "budgetNumber": "",\n  "cardEntryType": "UNDEFINED",\n  "cardLanguagePreference": "",\n  "cardSchemeName": "MasterCard",\n  "cardToken": "",\n  "chipTransactionReport": "",\n  "currency": "USD",\n  "customerReceipt": "https://s3.[...]/customerReceipt.html",\n  "customerReference": "",\n  "deviceStatus": {\n      "applicationName": "ClientApp",\n      "applicationVersion": "20.1.0",\n      "batteryCharging": "Not Charging",\n      "batteryStatus": "100",\n      "batterymV": "4126",\n      "bluetoothName": "PAXA920",\n      "externalPower": "USB",\n      "serialNumber": "0821032398",\n      "statusMessage": "Approved or completed successfully"\n  },\n  "dueAmount": 0,\n  "errorMessage": "",\n  "expiryDateMMYY": "0422",\n  "finStatus": "AUTHORISED",\n  "iad": "0210A000002A0000000000000000000000FF",\n  "issuerResponseCode": "00",\n  "maskedCardNumber": "************1456",\n  "merchantAddress": "Plaza Soledad Torres Acosta 1 28013 Madrid",\n  "merchantName": "Hago la cama",\n  "merchantReceipt": "https://s3.[...]/merchantReceipt.html",\n  "mid": "",\n  "originalEFTTransactionID": "",\n  "paymentScenario": "CHIPCONTACTLESS",\n  "rrn": "",\n  "signatureUrl": "",\n  "statusMessage": "Approved or completed successfully",\n  "tenderType": "CREDIT",\n  "tid": "ACQUIRER_TID",\n  "tipAmount": 0,\n  "totalAmount": 100,\n  "transactionID": "01236fc0-8192-11eb-9aca-ad4b0e95f241",\n  "tsi": "0000",\n  "tvr": "0400008001",\n  "type": "SALE",\n  "unMaskedPan": "",\n  "verificationMethod": "UNDEFINED",\n  "efttimestamp": 1615374961000,\n  "efttransactionID": "01236fc0-8192-11eb-9aca-ad4b0e95f241",\n  "requestedAmount": 100,\n  "tipPercentage": 0,\n  "recoveredTransaction": false,\n  "cardHolderName": "cardholder name"\n}\n')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"signatureUrl"),": In case the signature can not be updated to the Handpoint servers and an URL is not generated, the terminal will send back the image binary in base64 format to your software. It is important to be able to support both the URL and the image binary format."),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"customerReceipt")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"merchantReceipt"),": The receipts are usually received as URLs in the transaction result from the terminal. Please note that if the terminal is not able to upload the receipt to the Handpoint cloud servers and an URL is not generated then the HTML formatted receipt will be delivered to your software. It is important to be able to manage both formats.")),(0,r.kt)("h2",{id:"transactionsguidtip-adjustment"},"/transactions/{guid}/tip-adjustment"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"TipAdjustment")),(0,r.kt)("p",null,"POST endpoint used to execute a tip adjustment operation. "),(0,r.kt)("p",null,"A tip adjustment operation allows merchants to adjust the tip amount of a sale transaction before the batch of transactions is settled by the processor at the end of the day. Note: This functionality is only available for the restaurant industry in the United States and the processors currently supporting this functionality are TSYS and VANTIV. "),(0,r.kt)("p",null,"Note: If two tip adjustments are sent for the same original transaction, only the second one will be taken into account. Each new tip adjustment will override the previous one. A tip adjustment will be rejected if the original transaction has already been batched out by the acquirer."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Path parameter: guid")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"The guid of the transaction to be adjusted.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: Tip Adjustment")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"  ",(0,r.kt)("br",null),(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#tip-adjustment"},"TipAdjustment")),(0,r.kt)("td",{parentName:"tr",align:null},"Object containing the amount and currency of the tip adjustment.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returns")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response"),(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"OK")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code 200.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BadRequest")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code 400.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Code Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Operation executed using CLI tool CURL:\nREQUEST:\n    curl --location --request POST \'https://cloud.handpoint.com/transactions/ff6da784-8b57-11ed-9891-ebe2a88ff071/tip-adjustment\' (production)\\\n    curl --location --request POST \'https://cloud.handpoint.io/transactions/ff6da784-8b57-11ed-9891-ebe2a88ff071/tip-adjustment\' (development)\\\n          --header \'ApiKeyCloud: MeRcHaNt-ApI-KeY\' \\\n          --header \'Content-Type: application/json\' \\\n          --data-raw \'{\n              "amount": 5.25\n          }\'\n\nRESPONSE code 200:\n{\n    "statusMessage": "tip adjusted"\n}\n\nError example response (using invalid guid):\n{\n    "error": {\n        "statusCode": 400,\n        "name": "BadRequestError",\n        "message": "Invalid guid [fake-guid]"\n    }\n}\n')),(0,r.kt)("h2",{id:"transaction-result-recovery"},"Transaction Result Recovery"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"TransactionResultRecovery")),(0,r.kt)("p",null," The terminal has a transaction recovery loop to automatically send back the pending TransactionResult to the callback URL in case it becomes unreachable (network issue or server down)."),(0,r.kt)("p",null," For the first 100 seconds after a transaction is completed, a background thread will attempt to deliver the result every 5 seconds. If the server is still unreachable after the first 100 seconds, the retry loop turns into an exponential increment to the power of 2 (8s-16s-32s etc\u2026).\nThe recovery loop is reinitialized every time the Handpoint application is restarted or the startRecovery method is triggered. The Transaction Result received through the transaction recovery loop will have the ",(0,r.kt)("strong",{parentName:"p"},"recoveredTransaction")," field set to ",(0,r.kt)("strong",{parentName:"p"},"true"),"."),(0,r.kt)("p",null," All 2XXs http response codes from the callbackUrl are valid to notify the payment terminal of a successful delivery of the result."),(0,r.kt)("p",null," ",(0,r.kt)("strong",{parentName:"p"},"Returns")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transaction-result-object"},"Transaction Result")),(0,r.kt)("td",{parentName:"tr",align:null},"The ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transaction-result-object"},"Transaction Result")," is delivered to the callback URL from the ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transaction-request-object"},"Transaction Request"),".")))),(0,r.kt)("h2",{id:"transactionstransactionreferencestatus"},"/transactions/{transactionReference}/status"),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"This endpoint does ",(0,r.kt)("strong",{parentName:"p"},"not")," use ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://cloud.handpoint.(io/com)/"},"https://cloud.handpoint.(io/com)/"))," as a base URL, it uses ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://transactions.handpoint.(io/com)/"},"https://transactions.handpoint.(io/com)/")))),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"https://transactions.handpoint.com/transactions/{transactionReference}/status")," endpoint is a RESTful API endpoint designed to retrieve the status of the first transaction associated with a given ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference"),". This endpoint returns the status of the initial transaction linked to the reference, reflecting the current state of that transaction.The ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference")," is a unique value that you need to generate and pass in the original ",(0,r.kt)("a",{parentName:"p",href:"/restapi/next/restobjects#transactionRequest"}," transaction request"),"."),(0,r.kt)("p",null,"The main transaction result ",(0,r.kt)("a",{parentName:"p",href:"/restapi/next/restobjects#financialStatus"},(0,r.kt)("em",{parentName:"a"},"FinancialStatus"))," that can be returned as a response to this method are the following ones: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"AUTHORISED - Transaction was successful."),(0,r.kt)("li",{parentName:"ul"},"DECLINED - Transaction was declined."),(0,r.kt)("li",{parentName:"ul"},"UNDEFINED (NOT FOUND) -  The transaction does not exist in the Handpoint gateway. If this status is returned within 90s of the start of a transaction, there could be a chance that the cardholder has not inserted, swiped or tapped his card yet on the terminal and the Handpoint gateway might soon receive the transaction. If the ",(0,r.kt)("inlineCode",{parentName:"li"},"UNDEFINED")," status is returned after 90s, it means that the transaction processed has not reached the Handpoint gateway and it will NOT be charged."),(0,r.kt)("li",{parentName:"ul"},"IN_PROGRESS - The transaction has been received by the gateway but the outcome is not known yet, try again after a few seconds."),(0,r.kt)("li",{parentName:"ul"},"REFUNDED - Transaction was refunded.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"getTrxStatusEndpoint",src:a(58921).Z,width:"671",height:"611"})," "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Path parameter: transactionReference")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"The ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference")," is a ",(0,r.kt)("strong",{parentName:"td"},"UNIQUE")," ",(0,r.kt)("a",{parentName:"td",href:"https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_(random)"},"UUID v4")," generated by you and added as a parameter to the initial financial request. It can then be used to query the transaction status endpoint.")))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Handpoint does not verify that the ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference")," values sent on every request are ",(0,r.kt)("strong",{parentName:"p"},"UNIQUE"),".\nIt's our recommendation that a new value is created and sent for every request attempt.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Responses")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response"),(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"OK")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code ",(0,r.kt)("strong",{parentName:"td"},"200")," + ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transaction-result-object"},"Transaction Result"),". ",(0,r.kt)("br",null),(0,r.kt)("br",null)," There are two possible outcomes:",(0,r.kt)("br",null)," - The ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference")," was found in the database and the associated ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#transaction-result-object"},"Transaction Result")," object is delivered. By checking the ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#financialStatus"},"financial status")," field you will be able to know the status of the transaction at the time of the query. ",(0,r.kt)("br",null)," - The ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference")," was not found in the Handpoint gateway. The ",(0,r.kt)("a",{parentName:"td",href:"/restapi/next/restobjects#financialStatus"},"financial status")," received in this case will be ",(0,r.kt)("inlineCode",{parentName:"td"},"UNDEFINED")," (NOT FOUND)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Unauthorized")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code ",(0,r.kt)("strong",{parentName:"td"},"401"),". The client request has not been completed because it lacks valid authentication credentials for the requested resource. Please check your API Key is correct for this ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Forbidden")),(0,r.kt)("td",{parentName:"tr",align:null},"Response code ",(0,r.kt)("strong",{parentName:"td"},"403"),". Authentication was unsuccessful. Please check your API Key is valid.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Code Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Operation executed using CLI tool CURL:\nREQUEST:\n    curl -X GET \\\\\n      -H"ApiKeyCLoud: MeRcHaNt-ApIkEy" \\\\\n      "https://transactions.handpoint.com/transactions/3e665342-a95b-49c1-b6fe-b3f102305a76/status" (production)\n      "https://transactions.handpoint.io/transactions/3e665342-a95b-49c1-b6fe-b3f102305a76/status" (development)\n\nRESPONSE:\n{\n    "aid": "A0000000031010",\n    "arc": "00",\n    "iad": "06011103A00000",\n    "tsi": "0000",\n    "tvr": "0000000000",\n    "cardEntryType": "ICC",\n    "cardLanguagePreference": "",\n    "currency": "USD",\n    "type": "SALE",\n    "tipAmount": 0,\n    "totalAmount": 100,\n    "requestedAmount": 100,\n    "dueAmount": 0,\n    "tipPercentage": 0,\n    "efttimestamp": "20230511110113006",\n    "originalEFTTransactionID": "",\n    "paymentScenario": "CHIPCONTACTLESS",\n    "verificationMethod": "UNDEFINED",\n    "authorisationCode": "123456",\n    "cardSchemeName": "Visa",\n    "cardToken": "",\n    "maskedCardNumber": "************5733",\n    "cardTypeId": "",\n    "customerReference": "",\n    "efttransactionID": "66d94f20-efda-11ed-929c-47fffda5f9b5",\n    "transactionID": "66d94f20-efda-11ed-929c-47fffda5f9b5",\n    "errorMessage": "",\n    "expiryDateMMYY": "0924",\n    "issuerResponseCode": "00",\n    "rrn": "0000511573740",\n    "tenderType": "CREDIT",\n    "unMaskedPan": "",\n    "merchantAddress": "Navalaosa 48770 Madrid",\n    "merchantName": "Hago la cama 2",\n    "mid": "",\n    "cardHolderName": "",\n    "chipTransactionReport": "",\n    "customerReceipt": "",\n    "merchantReceipt": "",\n    "signatureUrl": "",\n    "statusMessage": "",\n    "tid": "",\n    "transactionReference": "3e665342-a95b-49c1-b6fe-b3f102305a76",\n    "transactionOrigin": "",\n    "finStatus": "AUTHORISED"\n}\n')),(0,r.kt)("h2",{id:"transactionstransactionreferencestatusselector"},"/transactions/{transactionReference}/status/{selector}"),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"This endpoint does ",(0,r.kt)("strong",{parentName:"p"},"not")," use ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://cloud.handpoint.(io/com)/"},"https://cloud.handpoint.(io/com)/"))," as a base URL, it uses ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://transactions.handpoint.(io/com)/"},"https://transactions.handpoint.(io/com)/")))),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"https://transactions.handpoint.io/transactions/{transactionReference}/status/{selector}")," endpoint is a RESTful API that retrieves the status of transactions associated with a given ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"{selector}")," path parameter allows you to specify whether you want to retrieve the status of a specific transaction by its index or retrieve all transactions associated with the ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Selector Values")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Selector"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"all"),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the status of all transactions associated with the given ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"first"),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the status of the first transaction associated with the ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"last"),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the status of the last transaction associated with the ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"{index}"),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the status of a specific transaction identified by its 1-based index in the sequence of transactions associated with the ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference"),". For example, ",(0,r.kt)("inlineCode",{parentName:"td"},"1")," for the first transaction, ",(0,r.kt)("inlineCode",{parentName:"td"},"2")," for the second, and so on.")))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Important Note:")," The ",(0,r.kt)("inlineCode",{parentName:"p"},"finStatus")," field for the first transaction reflects its current status. In contrast, for subsequent transactions, the finStatus reflects the original status at the time of processing. For example, if a refund is later reversed, the refund transaction will still show as AUTHORISED.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Path: transactionReference")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"The ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference")," is a ",(0,r.kt)("strong",{parentName:"td"},"UNIQUE")," ",(0,r.kt)("a",{parentName:"td",href:"https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_(random)"},"UUID v4")," generated by you and added as a parameter to the initial financial request. It is used to query the transaction status.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Path: selector")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Specifies whether to return all transactions or a specific transaction by index.")))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Handpoint does not verify that the ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionReference")," values sent on every request are ",(0,r.kt)("strong",{parentName:"p"},"UNIQUE"),".\nIt's our recommendation that a new value is created and sent for every request attempt.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Responses")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response"),(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"200 OK")),(0,r.kt)("td",{parentName:"tr",align:null},"The request was successful, and the transaction status(es) are returned in the response.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"404 Not Found")),(0,r.kt)("td",{parentName:"tr",align:null},"The specified ",(0,r.kt)("inlineCode",{parentName:"td"},"transactionReference")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"selector")," does not exist.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"403 Forbidden")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed. Please check that your API Key is valid.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Retrieve All Transactions:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X GET \\\n-H "ApiKeyCloud: your-api-key" \\\n"https://transactions.handpoint.io/transactions/123e4567-e89b-12d3-a456-426614174000/status/all"\n')))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Retrieve third transaction"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X GET \\\n-H "ApiKeyCloud: your-api-key" \\\n"https://transactions.handpoint.io/transactions/123e4567-e89b-12d3-a456-426614174000/status/3"\n')))),(0,r.kt)("h2",{id:"device-control-commands"},"Device Control Commands"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:"),(0,r.kt)("br",{parentName:"p"}),"\n","The following commands are available for all devices running Android SDK version 7.1006.0 or later.")),(0,r.kt)("p",null,"Command Endpoint Format"),(0,r.kt)("p",null,"All device control commands follow this endpoint structure:\n",(0,r.kt)("inlineCode",{parentName:"p"},"https://cloud.handpoint.io/devices/{deviceType}/{serialNumber}/{command}")),(0,r.kt)("p",null,"Where:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{deviceType}")," is the type of the device (e.g., PAXIM30)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{serialNumber}")," is the serial number of the device (e.g., 1640013848)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{command}")," is the specific command to execute")),(0,r.kt)("p",null,"Common Parameters"),(0,r.kt)("p",null,"All commands share these common parameters:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Api key used to authenticate the merchant. (UNIQUE per Merchant)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: Content-Type")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required"),"   ",(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Must be set to ",(0,r.kt)("inlineCode",{parentName:"td"},"application/json"))))),(0,r.kt)("p",null,"Common Response Codes"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Response Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"Request accepted, command will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"400"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid parameter value (when applicable)")))),(0,r.kt)("hr",null),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"For the Commands to work properly, the Handpoint Payments App ",(0,r.kt)("strong",{parentName:"p"},"MUST")," be in ",(0,r.kt)("strong",{parentName:"p"},"Integrated Mode")," (enabled via ",(0,r.kt)("strong",{parentName:"p"},"Handpoint TMS")," and controlled by the merchant in the ",(0,r.kt)("strong",{parentName:"p"},"Handpoint Payments App")," Settings).  Use the ",(0,r.kt)("a",{parentName:"p",href:"restobjects#operation-types-description"},(0,r.kt)("inlineCode",{parentName:"a"},"pingDevice")," operation")," to confirm the device is in Integrated Mode before you send these commands.",(0,r.kt)("br",null),"\nIf you attempt to send one of these commands and the device is not yet in Integrated Mode, you may receive a ",(0,r.kt)("strong",{parentName:"p"},"202 Accepted")," response but the command will not have been executed by the terminal.")),(0,r.kt)("h3",{id:"set-unattended-mode"},"Set Unattended Mode"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/set-unattended-mode")),(0,r.kt)("p",null,"Enables or disables unattended mode on the device.\nUnattended mode will disable the Bottom navigation bar containing the Home, back, recent buttons.\nThe Payment screen will be the only visible screen in the Handpoint Payments App. (Settings, Hisotry and Analytic tabs will not be accessible)"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"status")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")," to enable unattended mode, ",(0,r.kt)("inlineCode",{parentName:"td"},"false")," to disable")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "status": false\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/set-unattended-mode"\n')),(0,r.kt)("h3",{id:"set-locale"},"Set Locale"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/set-locale")),(0,r.kt)("p",null,"Sets the locale of the target device."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"locale")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"IETF BCP 47 language tag (e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"en_US"),"). Two-letter language and country code.")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response Codes")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"The request is accepted and will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "locale": "en_CA"\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/set-locale"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"set-password-protection"},"Set Password Protection"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/set-password-protected")),(0,r.kt)("p",null,"Enables or disables password protection on the device."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"status")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")," to enable password protection, ",(0,r.kt)("inlineCode",{parentName:"td"},"false")," to disable")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response Codes")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"The request is accepted and will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "status": true\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/set-password-protected"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"reboot-device"},"Reboot Device"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/reboot")),(0,r.kt)("p",null,"Reboots the device with an optional force parameter."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"force")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")," to force reboot even during transaction, ",(0,r.kt)("inlineCode",{parentName:"td"},"false")," to check status first")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response Codes")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"The request is accepted and will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "force": false\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/reboot"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"set-screen-brightness"},"Set Screen Brightness"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/set-screen-brightness")),(0,r.kt)("p",null,"Sets the screen brightness levels."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"minimumBrightnessLevel")),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Value between 0 and 100")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"maximumBrightnessLevel")),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Value between 0 and 100")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response Codes")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"The request is accepted and will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"400"),(0,r.kt)("td",{parentName:"tr",align:null},"Value is outside the valid range")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "minimumBrightnessLevel": 20,\n    "maximumBrightnessLevel": 100\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/set-screen-brightness"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"set-reboot-time"},"Set Reboot Time"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This feature is only enabled for production devices.")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /devices/{deviceType}/{serialNumber}/set-reboot-time")),(0,r.kt)("p",null,"Sets the daily reboot time for the device. The actual reboot will occur at a random minute within the specified hour."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Request Body Parameters")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"hour")),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Hour of the day (0-23) when device should reboot")))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If hour is set to 22, the device will reboot at a random time between 22:01 and 22:59.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response Codes")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Code"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"202"),(0,r.kt)("td",{parentName:"tr",align:null},"The request is accepted and will be executed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"403"),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication failed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"422"),(0,r.kt)("td",{parentName:"tr",align:null},"Invalid request")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"400"),(0,r.kt)("td",{parentName:"tr",align:null},"Value is outside the valid range")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example Request")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "hour": 22\n  }\' \\\n  "https://cloud.handpoint.io/devices/PAXIM30/0000000000/set-reboot-time"\n')),(0,r.kt)("h2",{id:"moto-operations-no-reader"},"MOTO Operations (no reader)"),(0,r.kt)("p",null,"MOTO (Mail Order / Telephone Order) operations can also be processed ",(0,r.kt)("strong",{parentName:"p"},"without a payment reader"),", using information\nthat is already stored in the gateway (tokens and references to previous transactions)."),(0,r.kt)("p",null,"These endpoints are intended for MOTO scenarios where the merchant does ",(0,r.kt)("strong",{parentName:"p"},"not")," need to collect or handle sensitive\ncard data (PAN, expiry date, CVV) in their own systems:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/moto/sale")," performs a sale using a ",(0,r.kt)("strong",{parentName:"li"},"previously generated card token")," (",(0,r.kt)("inlineCode",{parentName:"li"},"cardToken"),") that represents card details stored in the gateway."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/moto/refund")," performs a refund of a ",(0,r.kt)("strong",{parentName:"li"},"previous operation"),", using the card associated with that original operation (",(0,r.kt)("inlineCode",{parentName:"li"},"originalGuid"),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/moto/reversal")," performs a reversal (void) of a ",(0,r.kt)("strong",{parentName:"li"},"previous operation"),", passing only its identifier (",(0,r.kt)("inlineCode",{parentName:"li"},"originalGuid"),").")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Unlike the standard MOTO operations that use ",(0,r.kt)("inlineCode",{parentName:"p"},"/transactions")," and a physical terminal, these endpoints:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Do ",(0,r.kt)("strong",{parentName:"li"},"not")," require ",(0,r.kt)("inlineCode",{parentName:"li"},"serial_number")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"terminal_type"),"."),(0,r.kt)("li",{parentName:"ul"},"Do ",(0,r.kt)("strong",{parentName:"li"},"not")," receive raw card data in the request."),(0,r.kt)("li",{parentName:"ul"},"Rely on ",(0,r.kt)("inlineCode",{parentName:"li"},"cardToken")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"originalGuid")," to reference card information already stored in the gateway."))),(0,r.kt)("p",null,"All request and response payloads are defined in the corresponding ",(0,r.kt)("a",{parentName:"p",href:"restobjects#moto"},"Moto objects"),"."),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"motosale"},"/moto/sale"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"MotoSale")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /moto/sale")," is used to perform a ",(0,r.kt)("strong",{parentName:"p"},"MOTO sale without a payment reader"),", using a ",(0,r.kt)("strong",{parentName:"p"},"card token")," (",(0,r.kt)("inlineCode",{parentName:"p"},"cardToken"),")\nthat was generated previously (for example, by a ",(0,r.kt)("inlineCode",{parentName:"p"},"saleAndTokenizeCard")," operation)."),(0,r.kt)("p",null,"The card details are ",(0,r.kt)("em",{parentName:"p"},"not")," sent in the request; they are resolved by the gateway using the ",(0,r.kt)("inlineCode",{parentName:"p"},"cardToken"),"."),(0,r.kt)("p",null,"Typical flow:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A card is captured securely in a previous flow, for example through the ",(0,r.kt)("a",{parentName:"li",href:"restendpoints#transactions"},(0,r.kt)("inlineCode",{parentName:"a"},"/transactions"))," endpoint using a\n",(0,r.kt)("inlineCode",{parentName:"li"},"saleAndTokenizeCard")," operation."),(0,r.kt)("li",{parentName:"ol"},"The gateway returns a ",(0,r.kt)("inlineCode",{parentName:"li"},"cardToken")," (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"665630867"),")."),(0,r.kt)("li",{parentName:"ol"},"The integrator can later perform one or more MOTO sales using that ",(0,r.kt)("inlineCode",{parentName:"li"},"cardToken"),", without handling PAN/CVV again.")),(0,r.kt)("h4",{id:"parameters"},"Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},"Cloud API key used to authenticate the merchant.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: MotoSaleRequest")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"restobjects#motoSaleRequest"},"MotoSaleRequest")," object containing ",(0,r.kt)("inlineCode",{parentName:"td"},"cardToken"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"amount"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"currency")," and optional merchant references.")))),(0,r.kt)("p",null,"Typical fields in the request body (see ",(0,r.kt)("a",{parentName:"p",href:"restobjects#motoSaleRequest"},"MotoSaleRequest")," for full details):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cardToken")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 Token representing the card stored in the gateway (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"665630867"'),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"amount")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 String amount with dot as decimal separator (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"20.00"'),"), matching ",(0,r.kt)("inlineCode",{parentName:"li"},"^\\d+(\\.\\d+)?$"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"currency")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 3-character ISO 4217 currency code (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"EUR"'),")."),(0,r.kt)("li",{parentName:"ul"},"Optional references for reconciliation: ",(0,r.kt)("inlineCode",{parentName:"li"},"customerReference"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"transactionReference"),", etc.")),(0,r.kt)("h4",{id:"returns"},"Returns"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Result"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"200")),(0,r.kt)("td",{parentName:"tr",align:null},"Sale successfully processed. The response body is a ",(0,r.kt)("inlineCode",{parentName:"td"},"motoSaleResponse")," ",(0,r.kt)("a",{parentName:"td",href:"restobjects#motoTransactionResponse"},"Moto Transaction Response")," with the authorization result (approved/declined), authorization code, masked card details, acquirer TID, timestamps, etc.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"400")),(0,r.kt)("td",{parentName:"tr",align:null},"Business rule error from the payment gateway (for example, CVV required, card token failure). Returned as ",(0,r.kt)("inlineCode",{parentName:"td"},"BadRequestError"),", with ",(0,r.kt)("inlineCode",{parentName:"td"},"error.code")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"error.details")," containing the gateway error code and description.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"422")),(0,r.kt)("td",{parentName:"tr",align:null},"Payload validation error (",(0,r.kt)("inlineCode",{parentName:"td"},"VALIDATION_FAILED"),") when required fields are missing or do not match the schema (invalid amount pattern, currency length, etc.).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"5xx")),(0,r.kt)("td",{parentName:"tr",align:null},"Internal error or gateway unavailability. The final outcome may be unknown and may require reconciliation.")))),(0,r.kt)("h4",{id:"behaviour-examples"},"Behaviour examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CVV required (3107)")," \u2014 merchant configured with \u201cCVV/CV2 input mandatory\u201d for Card Not Present:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"http POST https://cloud.handpoint.io/moto/sale \\\n  ApiKeyCloud:XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX \\\n  amount='20.00' \\\n  currency='EUR' \\\n  cardToken='665630867'\n")),(0,r.kt)("p",null,"Example response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "statusCode": 400,\n    "name": "BadRequestError",\n    "message": "CVV required",\n    "code": "3107",\n    "details": {\n      "errorGuid": "dae59b20-cf71-11f0-b588-a122fae316de",\n      "errorCode": "3107",\n      "description": "CVV required",\n      "httpStatus": 400\n    }\n  }\n}\n')),(0,r.kt)("p",null,"A very common cause of ",(0,r.kt)("strong",{parentName:"p"},"3107")," is having \u201cCVV/CV2 input mandatory\u201d enabled for Card Not Present."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Invalid / unknown card token (5252)"),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "5252",\n    "details": {\n      "description": "Card token failure",\n      "errorCode": "5252",\n      "errorGuid": "10a3d120-cf75-11f0-95b2-770b7d1d8e67",\n      "httpStatus": 404\n    },\n    "message": "Card token failure",\n    "name": "BadRequestError",\n    "statusCode": 400\n  }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Validation errors (422 ",(0,r.kt)("inlineCode",{parentName:"strong"},"VALIDATION_FAILED"),")")," \u2013 for example, missing ",(0,r.kt)("inlineCode",{parentName:"p"},"amount"),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "VALIDATION_FAILED",\n    "details": [\n      {\n        "code": "required",\n        "info": {\n          "missingProperty": "amount"\n        },\n        "message": "must have required property \'amount\'",\n        "path": ""\n      }\n    ],\n    "message": "The request body is invalid. See error object `details` property for more info.",\n    "name": "UnprocessableEntityError",\n    "statusCode": 422\n  }\n}\n')))),(0,r.kt)("h4",{id:"code-example--moto-sale-with-cardtoken"},"Code example \u2013 MOTO sale with ",(0,r.kt)("inlineCode",{parentName:"h4"},"cardToken")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "Content-Type: application/json" \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -d \'{\n    "amount": "20.00",\n    "currency": "EUR",\n    "cardToken": "665630867",\n    "customerReference": "order-12345",\n    "transactionReference": "b7b2360d-3e9e-4b62-9a3a-2e6ef6c5cd01"\n  }\' \\\n  "https://cloud.handpoint.io/moto/sale"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"motorefund"},"/moto/refund"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"MotoRefund")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /moto/refund")," is used to perform a ",(0,r.kt)("strong",{parentName:"p"},"MOTO refund without a payment reader"),"."),(0,r.kt)("p",null,"The refund is ",(0,r.kt)("strong",{parentName:"p"},"linked")," to a previous MOTO sale via ",(0,r.kt)("inlineCode",{parentName:"p"},"originalGuid"),", and the gateway reuses the card associated with that\noriginal transaction. No card data is passed in the refund request."),(0,r.kt)("h4",{id:"parameters-1"},"Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},"Cloud API key used to authenticate the merchant.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: MotoRefundRequest")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"restobjects#motoRefundRequest"},"MotoRefundRequest")," object containing ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"amount"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"currency")," and optional merchant references.")))),(0,r.kt)("p",null,"Typical fields (see ",(0,r.kt)("a",{parentName:"p",href:"restobjects#motoRefundRequest"},"MotoRefundRequest")," for full details):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"originalGuid")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 GUID of the original sale to be refunded (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"1a41d9f0-cf72-11f0-95b2-770b7d1d8e67"'),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"amount")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 String amount to be refunded (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"5.00"'),"), matching ",(0,r.kt)("inlineCode",{parentName:"li"},"^\\d+(\\.\\d+)?$"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"currency")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 3-character ISO 4217 code (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"EUR"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"USD"'),")."),(0,r.kt)("li",{parentName:"ul"},"Optional: ",(0,r.kt)("inlineCode",{parentName:"li"},"customerReference"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"transactionReference"),".")),(0,r.kt)("p",null,"Supports full and partial refunds, depending on acquirer configuration."),(0,r.kt)("h4",{id:"returns-1"},"Returns"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Result"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"200")),(0,r.kt)("td",{parentName:"tr",align:null},"Refund successfully processed. The response body is a ",(0,r.kt)("inlineCode",{parentName:"td"},"motoRefundResponse")," ",(0,r.kt)("a",{parentName:"td",href:"restobjects#motoTransactionResponse"},"Moto Transaction Response")," including ",(0,r.kt)("inlineCode",{parentName:"td"},"guid"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"amount"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"currency"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"maskedCardNumber"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"approvalCode"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"issuerResponseText"),", etc.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"400")),(0,r.kt)("td",{parentName:"tr",align:null},"Business rule error from the payment gateway (for example, currency mismatch, refund amount greater than the original sale). Returned as ",(0,r.kt)("inlineCode",{parentName:"td"},"BadRequestError"),", with ",(0,r.kt)("inlineCode",{parentName:"td"},"error.code")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"error.details")," describing the gateway error.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"422")),(0,r.kt)("td",{parentName:"tr",align:null},"Payload validation error (",(0,r.kt)("inlineCode",{parentName:"td"},"VALIDATION_FAILED"),") when required fields are missing or invalid (missing ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", invalid amount, invalid currency format, etc.).")))),(0,r.kt)("h4",{id:"behaviour-examples-1"},"Behaviour examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Partial refund \u2013 happy path")," (EUR 5.00 of a 20.00 EUR sale):"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"http POST https://cloud.handpoint.io/moto/refund \\\n  ApiKeyCloud:XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX \\\n  originalGuid='1a41d9f0-cf72-11f0-95b2-770b7d1d8e67' \\\n  amount='5.00' \\\n  currency='EUR'\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Currency mismatch (3210)")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "3210",\n    "details": {\n      "description": "Original and linked currency do not match",\n      "errorCode": "3210",\n      "errorGuid": "35a2b220-cf7a-11f0-b588-a122fae316de",\n      "httpStatus": 400\n    },\n    "message": "Original and linked currency do not match",\n    "name": "BadRequestError",\n    "statusCode": 400\n  }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Refund amount greater than original (3209)")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "3209",\n    "details": {\n      "description": "The requested refund amount is greater than the initial sale amount",\n      "errorCode": "3209",\n      "errorGuid": "e72ea940-cf7a-11f0-b588-a122fae316de",\n      "httpStatus": 400\n    },\n    "message": "The requested refund amount is greater than the initial sale amount",\n    "name": "BadRequestError",\n    "statusCode": 400\n  }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Validation errors")," \u2013 missing ",(0,r.kt)("inlineCode",{parentName:"p"},"originalGuid"),", missing ",(0,r.kt)("inlineCode",{parentName:"p"},"amount"),", invalid ",(0,r.kt)("inlineCode",{parentName:"p"},"currency")," length, invalid ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," pattern \u2014 are returned as ",(0,r.kt)("inlineCode",{parentName:"p"},"422 VALIDATION_FAILED")," with one or more entries in ",(0,r.kt)("inlineCode",{parentName:"p"},"error.details"),"."))),(0,r.kt)("h4",{id:"code-example--partial-moto-refund-by-originalguid"},"Code example \u2013 partial MOTO refund by ",(0,r.kt)("inlineCode",{parentName:"h4"},"originalGuid")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "Content-Type: application/json" \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -d \'{\n    "originalGuid": "1a41d9f0-cf72-11f0-95b2-770b7d1d8e67",\n    "amount": "5.00",\n    "currency": "EUR",\n    "customerReference": "refund-98765",\n    "transactionReference": "a1fe8db5-69a4-4b4d-a704-94ac2570f9b0"\n  }\' \\\n  "https://cloud.handpoint.io/moto/refund"\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"motoreversal"},"/moto/reversal"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"MotoReversal")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /moto/reversal")," is used to ",(0,r.kt)("strong",{parentName:"p"},"reverse (void)")," a previous MOTO operation processed via the no-reader MOTO endpoints."),(0,r.kt)("p",null,"The request is linked to the original sale via ",(0,r.kt)("inlineCode",{parentName:"p"},"originalGuid"),". No card data is sent; the gateway uses the original\ntransaction information."),(0,r.kt)("p",null,"Reversals are typically used to cancel a MOTO sale shortly after authorization, subject to acquirer rules."),(0,r.kt)("h4",{id:"parameters-2"},"Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},"Cloud API key used to authenticate the merchant.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: MotoReversalRequest")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"restobjects#motoReversalRequest"},"MotoReversalRequest")," object referencing the original MOTO transaction (",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),") and including the reversal ",(0,r.kt)("inlineCode",{parentName:"td"},"amount")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"currency"),".")))),(0,r.kt)("p",null,"Typical fields (see ",(0,r.kt)("a",{parentName:"p",href:"restobjects#motoReversalRequest"},"MotoReversalRequest")," for full details):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"originalGuid")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 GUID of the original sale to be reversed."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"amount")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 String amount to reverse (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},'"20.00"'),"), ",(0,r.kt)("inlineCode",{parentName:"li"},"^\\d+(\\.\\d+)?$"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"currency")," ",(0,r.kt)("span",{class:"badge badge--secondary"},"Optional")," \u2013 3-character ISO 4217 code; if provided, must respect ",(0,r.kt)("inlineCode",{parentName:"li"},"minLength = 3"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"maxLength = 3")," and may need to match the original transaction\u2019s currency."),(0,r.kt)("li",{parentName:"ul"},"Optional merchant references: ",(0,r.kt)("inlineCode",{parentName:"li"},"customerReference"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"transactionReference"),".")),(0,r.kt)("h4",{id:"returns-2"},"Returns"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Result"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"200")),(0,r.kt)("td",{parentName:"tr",align:null},"Reversal accepted and processed. Response body is a ",(0,r.kt)("inlineCode",{parentName:"td"},"motoReversalResponse")," ",(0,r.kt)("a",{parentName:"td",href:"restobjects#motoTransactionResponse"},"Moto Transaction Response")," indicating whether the reversal was approved, with fields such as ",(0,r.kt)("inlineCode",{parentName:"td"},"guid"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"issuerResponseCode"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"issuerResponseText"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"f25"),", etc.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"400")),(0,r.kt)("td",{parentName:"tr",align:null},"Business rule error from the payment gateway (for example, unknown ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", reversal not allowed). Returned as ",(0,r.kt)("inlineCode",{parentName:"td"},"BadRequestError"),", with ",(0,r.kt)("inlineCode",{parentName:"td"},"error.code")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"error.details")," describing the gateway error (for example, code ",(0,r.kt)("inlineCode",{parentName:"td"},"3153"),").")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"422")),(0,r.kt)("td",{parentName:"tr",align:null},"Payload validation error (",(0,r.kt)("inlineCode",{parentName:"td"},"VALIDATION_FAILED"),") when required fields are missing or invalid (missing ",(0,r.kt)("inlineCode",{parentName:"td"},"originalGuid"),", missing ",(0,r.kt)("inlineCode",{parentName:"td"},"amount"),", invalid ",(0,r.kt)("inlineCode",{parentName:"td"},"currency"),", invalid ",(0,r.kt)("inlineCode",{parentName:"td"},"amount")," pattern).")))),(0,r.kt)("h4",{id:"behaviour-examples-2"},"Behaviour examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Happy path \u2013 full MOTO reversal")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"http POST https://cloud.handpoint.io/moto/reversal \\\n  ApiKeyCloud:XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX \\\n  originalGuid='b28bdb10-cf87-11f0-b588-a122fae316de' \\\n  amount='20.00' \\\n  currency='EUR'\n")),(0,r.kt)("p",{parentName:"li"},"Typical success response (simplified):"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "motoReversalResponse",\n  "httpStatus": 200,\n  "amount": "20.00",\n  "currency": "EUR",\n  "guid": "3f7772a0-cf88-11f0-b588-a122fae316de",\n  "originalGuid": "b28bdb10-cf87-11f0-b588-a122fae316de",\n  "issuerResponseCode": "00",\n  "issuerResponseText": "Successful",\n  "maskedCardNumber": "************3555",\n  "f25": "4000"\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Unknown / invalid ",(0,r.kt)("inlineCode",{parentName:"strong"},"originalGuid")," (3153)")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "3153",\n    "details": {\n      "description": "Unable to find message to reverse.",\n      "errorCode": "3153",\n      "errorGuid": "633a4370-cf88-11f0-b588-a122fae316de",\n      "httpStatus": 404\n    },\n    "message": "Unable to find message to reverse.",\n    "name": "BadRequestError",\n    "statusCode": 400\n  }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Validation errors")," \u2013 missing ",(0,r.kt)("inlineCode",{parentName:"p"},"originalGuid"),", missing ",(0,r.kt)("inlineCode",{parentName:"p"},"amount"),", invalid ",(0,r.kt)("inlineCode",{parentName:"p"},"currency")," length, invalid ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," pattern \u2014 result in ",(0,r.kt)("inlineCode",{parentName:"p"},"422 VALIDATION_FAILED")," with one or more entries in ",(0,r.kt)("inlineCode",{parentName:"p"},"error.details"),"."))),(0,r.kt)("h4",{id:"code-example--moto-reversal-by-originalguid"},"Code example \u2013 MOTO reversal by ",(0,r.kt)("inlineCode",{parentName:"h4"},"originalGuid")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "Content-Type: application/json" \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -d \'{\n    "originalGuid": "b28bdb10-cf87-11f0-b588-a122fae316de",\n    "amount": "20.00",\n    "currency": "EUR",\n    "customerReference": "void-001",\n    "transactionReference": "4d7b1a2c-5bfd-4a30-9b6f-123456789abc"\n  }\' \\\n  "https://cloud.handpoint.io/moto/reversal"\n')),(0,r.kt)("h2",{id:"batch-operations"},"Batch Operations"),(0,r.kt)("p",null,"Batch operations allow you to remotely ",(0,r.kt)("strong",{parentName:"p"},"close a batch on a specific payment terminal")," using Cloud API."),(0,r.kt)("p",null,"These endpoints are typically used in scenarios where the acquirer or merchant workflow is batch-based (for example,\ndaily settlement batches per terminal)."),(0,r.kt)("p",null,"Currently, the primary batch operation exposed via Cloud API is:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"POST /batch/close")," \u2014 requests the ",(0,r.kt)("strong",{parentName:"li"},"closure of a batch")," for a given terminal (",(0,r.kt)("inlineCode",{parentName:"li"},"deviceType"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"serialNumber"),") and ",(0,r.kt)("inlineCode",{parentName:"li"},"batchNumber"),".")),(0,r.kt)("p",null,"All request and response payloads are defined in the corresponding ",(0,r.kt)("a",{parentName:"p",href:"restobjects#batch"},"Batch objects"),"."),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"batchclose"},"/batch/close"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"BatchClose")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"POST /batch/close")," is used to request ",(0,r.kt)("strong",{parentName:"p"},"closure of a batch")," for a specific payment terminal, identified by its\n",(0,r.kt)("inlineCode",{parentName:"p"},"deviceType")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"serialNumber"),", and a ",(0,r.kt)("inlineCode",{parentName:"p"},"batchNumber"),"."),(0,r.kt)("p",null,"Typical use cases:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"End-of-day batch closure triggered from a back-office or back-office job."),(0,r.kt)("li",{parentName:"ul"},"Manual batch close as part of a support or reconciliation process.")),(0,r.kt)("h4",{id:"parameters-3"},"Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Header: ApiKeyCloud")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},"Cloud API key used to authenticate the merchant.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Request Body: BatchCloseRequest")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"restobjects#batchCloseRequest"},"BatchCloseRequest")," object containing ",(0,r.kt)("inlineCode",{parentName:"td"},"deviceType"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"serialNumber")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"batchNumber"),".")))),(0,r.kt)("p",null,"Typical fields in the request body (see ",(0,r.kt)("a",{parentName:"p",href:"restobjects#batchCloseRequest"},"BatchCloseRequest")," for full details):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"deviceType")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 Terminal model identifier (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},'"PAXA920MAX"'),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"serialNumber")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 Serial number of the payment terminal (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},'"2740013262"'),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"batchNumber")," ",(0,r.kt)("span",{class:"badge badge--primary"},"Required")," \u2013 Identifier of the batch to close (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},'"1"'),").")),(0,r.kt)("h4",{id:"returns-3"},"Returns"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Result"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"200")),(0,r.kt)("td",{parentName:"tr",align:null},"Batch close request accepted. The response body is a ",(0,r.kt)("a",{parentName:"td",href:"restobjects#batchCloseResponse"},"BatchCloseResponse")," with the batch number, a unique ",(0,r.kt)("inlineCode",{parentName:"td"},"closeBatchGuid"),", timestamps and an issuer-style response code/text.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"400")),(0,r.kt)("td",{parentName:"tr",align:null},"Business rule error or generic gateway error. Returned as ",(0,r.kt)("inlineCode",{parentName:"td"},"BadRequestError"),", with ",(0,r.kt)("inlineCode",{parentName:"td"},"error.code"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"error.message")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"error.details")," describing the problem.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"422")),(0,r.kt)("td",{parentName:"tr",align:null},"Payload validation error (",(0,r.kt)("inlineCode",{parentName:"td"},"VALIDATION_FAILED"),") when required fields are missing or do not match the schema (for example, missing ",(0,r.kt)("inlineCode",{parentName:"td"},"batchNumber"),").")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"5xx")),(0,r.kt)("td",{parentName:"tr",align:null},"Internal error or service unavailability. The final outcome of the batch close may be unknown and may require reconciliation or a retry at a later time.")))),(0,r.kt)("h4",{id:"behaviour-examples-3"},"Behaviour examples"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Happy path \u2013 close batch 1 for a terminal")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"http POST https://cloud.handpoint.io/batch/close \\\n  ApiKeyCloud:XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX \\\n  deviceType='PAXA920MAX' \\\n  serialNumber='2740013262' \\\n  batchNumber='1'\n")),(0,r.kt)("p",null,"Example response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "batchNumber": "1",\n  "closeBatchGuid": "14431ad0-d0dc-11f0-9ed0-695d1a368668",\n  "closedAt": "20251204064010281",\n  "customerReference": {},\n  "httpStatus": "200",\n  "issuerResponseCode": "00",\n  "issuerResponseText": "ACCEPTED"\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Validation error \u2013 missing ",(0,r.kt)("inlineCode",{parentName:"strong"},"batchNumber"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"http POST https://cloud.handpoint.io/batch/close \\\n  ApiKeyCloud:XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX \\\n  deviceType='PAXA920MAX' \\\n  serialNumber='2740013262'\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "code": "VALIDATION_FAILED",\n    "details": [\n      {\n        "code": "required",\n        "info": {\n          "missingProperty": "batchNumber"\n        },\n        "message": "must have required property \'batchNumber\'",\n        "path": ""\n      }\n    ],\n    "message": "The request body is invalid. See error object `details` property for more info.",\n    "name": "UnprocessableEntityError",\n    "statusCode": 422\n  }\n}\n')),(0,r.kt)("h4",{id:"code-example--close-batch-via-curl"},"Code example \u2013 Close batch via ",(0,r.kt)("inlineCode",{parentName:"h4"},"curl")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -X POST \\\n  -H "Content-Type: application/json" \\\n  -H "ApiKeyCloud: XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX" \\\n  -d \'{\n    "deviceType": "PAXA920MAX",\n    "serialNumber": "2740013262",\n    "batchNumber": "1"\n  }\' \\\n  "https://cloud.handpoint.io/batch/close"\n')))}m.isMDXComponent=!0},58921:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/getTransactionStatusEndpoint.drawio-c446aeef53cce796e297b0f95ff8318a.png"}}]);